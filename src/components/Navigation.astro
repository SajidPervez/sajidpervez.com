<header class="relative z-20">
  <div class="flex w-full px-4 py-4 items-center justify-between">
    <!-- Logo aligned to the left -->
    <div class="flex items-center">
      <a href="/" class="no-underline flex items-center">
        <img src="/favicon-beige.png" alt="Sajid." width="50em" height="50em" />
      </a>
    </div>

    <!-- Hamburger Button for Mobile -->
    <button
      id="menu-toggle"
      class="sm:hidden text-gray-700 focus:outline-none"
      aria-label="Toggle navigation"
    >
      <svg
        id="menu-icon"
        class="h-6 w-6"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M4 6h16M4 12h16m-7 6h7"
        ></path>
      </svg>
    </button>

    <!-- Menu Items aligned to the right -->
    <div
      id="menu"
      class="hidden sm:flex flex-col sm:flex-row ml-auto space-y-4 sm:space-y-0 sm:space-x-4 items-center w-full sm:w-auto text-sm"
    >
      <!-- All Menu Options for Mobile -->
      <div class="sm:hidden flex flex-col items-start w-full px-4 py-4 relative">
        <!-- Close Button at the top right corner -->
        <button
          id="menu-close"
          class="absolute top-4 right-4 text-gray-700 focus:outline-none"
          aria-label="Close navigation"
        >
          <svg
            class="h-6 w-6"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M6 18L18 6M6 6l12 12"
            />
          </svg>
        </button>
        <!-- Menu Links -->
        <a href="/" class="block px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-200 text-sm">Home</a>
        <a href="/blog/" class="block px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-200 text-sm">Essays</a>
        <a href="/books/" class="block px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-200 text-sm">Reading Corner</a>
        <a href="/podcasts/" class="block px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-200 text-sm">Listening</a>
        <a href="/merch/" class="block px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-200 text-sm">Cyber Merch</a>
        <a href="/about/" class="block px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-200 text-sm">About</a>
      </div>

      <!-- The Core with Dropdown for Desktop -->
      <div class="relative hidden sm:inline-block">
        <button
          class="hover:bg-gray-200 px-2 py-2 rounded-lg text-gray-700 flex items-center"
          id="core-button"
        >
          The Core
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="ml-1 h-4 w-4"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M19 9l-7 7-7-7"
            />
          </svg>
        </button>
        <!-- Dropdown Menu for Desktop -->
        <ul
          id="dropdown"
          class="absolute left-0 mt-2 w-48 z-30 bg-white border rounded-lg shadow-lg hidden"
        >
          <li>
            <a href="/blog/" class="block px-4 py-2 hover:bg-gray-200 text-gray-700 text-sm">Essays</a>
          </li>
          <li>
            <a href="/books/" class="block px-4 py-2 hover:bg-gray-200 text-gray-700 text-sm">Reading Corner</a>
          </li>
          <li>
            <a href="/podcasts/" class="block px-4 py-2 hover:bg-gray-200 text-gray-700 text-sm">Listening</a>
          </li>
          <li>
            <a href="/merch/" class="block px-4 py-2 hover:bg-gray-200 text-gray-700 text-sm">Cyber Merch</a>
          </li>
        </ul>
      </div>

      <!-- About Link for Desktop -->
      <a href="/about/" class="hidden sm:block hover:bg-gray-200 px-2 py-2 rounded-lg text-gray-700 text-sm">
        About
      </a>
    </div>
  </div>
</header>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const menu = document.getElementById('menu');
    const menuIcon = document.getElementById('menu-icon');
    const dropdown = document.getElementById('dropdown');

    // Function to toggle menu visibility
    function toggleMenu() {
      menu?.classList.toggle('hidden');
      menuIcon?.classList.toggle('hidden');
    }

    // Use event delegation for menu toggle, close, and other interactions
    document.body.addEventListener('click', function(event) {
      const target = event.target as Element;
      
      if (target.closest('#menu-toggle')) {
        toggleMenu();
      } else if (target.closest('#menu-close')) {
        toggleMenu();
      } else if (target.closest('#core-button')) {
        dropdown?.classList.toggle('hidden');
      } else if (!target.closest('#menu') && !menu?.classList.contains('hidden')) {
        toggleMenu();
      } else if (!target.closest('#core-button') && !dropdown?.classList.contains('hidden')) {
        dropdown?.classList.add('hidden');
      }
    });

    // Prevent clicks inside the menu from closing it, except for the close button
    menu?.addEventListener('click', function(event) {
      const target = event.target as Element;
      if (!target.closest('#menu-close')) {
        event.stopPropagation();
      }
    });
  });
</script>

