<header class="relative z-20">
  <div class="flex w-full px-4 py-4 items-center justify-between">
    <!-- Logo aligned to the left -->
    <div class="flex items-center">
      <a href="/" class="no-underline flex items-center">
        <img src="/favicon-beige.png" alt="Sajid." width="50em" height="50em" />
      </a>
    </div>

    <!-- Hamburger Button for Mobile -->
    <button
      id="mobile-menu-toggle"
      class="sm:hidden text-gray-700 focus:outline-none"
      aria-label="Toggle navigation"
    >
      <svg
        class="h-6 w-6"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M4 6h16M4 12h16m-7 6h7"
        ></path>
      </svg>
    </button>

    <!-- Mobile Menu -->
    <div
      id="mobile-menu"
      class="hidden fixed inset-0 bg-white z-50 sm:hidden"
    >
      <div class="flex flex-col items-start w-full px-4 py-4 relative">
        <button
          id="mobile-menu-close"
          class="absolute top-4 right-4 text-gray-700 focus:outline-none"
          aria-label="Close navigation"
        >
          <svg
            class="h-6 w-6"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M6 18L18 6M6 6l12 12"
            />
          </svg>
        </button>
        <a href="/" class="block px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-200 text-sm">Home</a>
        <a href="/blog/" class="block px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-200 text-sm">Essays</a>
        <a href="/books/" class="block px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-200 text-sm">Reading Corner</a>
        <a href="/podcasts/" class="block px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-200 text-sm">Listening</a>
        <a href="/merch/" class="block px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-200 text-sm">Cyber Merch</a>
        <a href="/about/" class="block px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-200 text-sm">About</a>
      </div>
    </div>

    <!-- Desktop Menu -->
    <div class="hidden sm:flex items-center space-x-4">
      <div class="relative">
        <button
          class="hover:bg-gray-200 px-2 py-2 rounded-lg text-gray-700 flex items-center"
          id="desktop-core-button"
        >
          The Core
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="ml-1 h-4 w-4"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M19 9l-7 7-7-7"
            />
          </svg>
        </button>
        <ul
          id="desktop-dropdown"
          class="absolute left-0 mt-2 w-48 bg-white border rounded-lg shadow-lg hidden"
        >
          <li><a href="/blog/" class="block px-4 py-2 hover:bg-gray-200 text-gray-700 text-sm">Essays</a></li>
          <li><a href="/books/" class="block px-4 py-2 hover:bg-gray-200 text-gray-700 text-sm">Reading Corner</a></li>
          <li><a href="/podcasts/" class="block px-4 py-2 hover:bg-gray-200 text-gray-700 text-sm">Listening</a></li>
          <li><a href="/merch/" class="block px-4 py-2 hover:bg-gray-200 text-gray-700 text-sm">Cyber Merch</a></li>
        </ul>
      </div>
      <a href="/about/" class="hover:bg-gray-200 px-2 py-2 rounded-lg text-gray-700 text-sm">About</a>
    </div>
  </div>
</header>

<script>
  document.addEventListener('astro:page-load', () => {
    const mobileMenu = document.getElementById('mobile-menu');
    const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
    const mobileMenuClose = document.getElementById('mobile-menu-close');
    const desktopCoreButton = document.getElementById('desktop-core-button');
    const desktopDropdown = document.getElementById('desktop-dropdown');

    mobileMenuToggle?.addEventListener('click', () => {
      mobileMenu?.classList.toggle('hidden');
    });

    mobileMenuClose?.addEventListener('click', () => {
      mobileMenu?.classList.add('hidden');
    });

    desktopCoreButton?.addEventListener('click', () => {
      desktopDropdown?.classList.toggle('hidden');
    });

    document.addEventListener('click', (event) => {
      if (!event.target.closest('#mobile-menu') && !event.target.closest('#mobile-menu-toggle')) {
        mobileMenu?.classList.add('hidden');
      }
      if (!event.target.closest('#desktop-core-button') && !event.target.closest('#desktop-dropdown')) {
        desktopDropdown?.classList.add('hidden');
      }
    });

    window.addEventListener('resize', () => {
      if (window.innerWidth >= 640) { // sm breakpoint
        mobileMenu?.classList.add('hidden');
      }
    });
  });
</script>